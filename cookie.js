const EU_COUNTRIES = [ "AL","AD","AM","AT","AZ","BY","BE","BA","BG","HR","CY","CZ","DK","EE","FI","FR","GE","DE","GR","HU","IS","IE","IT","KZ","XK","LV","LI","LT","LU","MT","MD","MC","ME","NL","MK","NO","PL","PT","RO","RU","SM","RS","SK","SI","ES","SE","CH","TR","UA","GB","VA",];function isEEAVisitor() {if (!locationData || !locationData.country) return true;return EU_COUNTRIES.includes(locationData.country);}const config = {allowedDomains: ['www.makeagency.it'],privacyPolicyUrl: 'https://www.makeagency.it/#privacy-policy',bannerTriggers: {enabled: true,triggerText: "Quick Links",triggerClass: "cookie-banners-trigger",triggerId: "cookie-banner-trigger" },urlFilter: {enabled: false,showOnUrls: [ '/example-privacy-policy','/example-about-us','/example-contact','/example-blog .cookie-consent-banner {position: fixed;bottom: 20px;${config.behavior.bannerPosition === 'left' ? 'left: 20px;' : 'right: 20px;'}width: ${config.bannerStyle.width};background: ${config.bannerStyle.background};border-radius: ${config.bannerStyle.borderRadius};box-shadow: ${config.bannerStyle.boxShadow};z-index: 9999;padding: ${config.bannerStyle.padding};font-family: 'Inter',-apple-system,BlinkMacSystemFont,sans-serif;display: none;transform: translateY(20px);opacity: 0;transition: all ${config.behavior.bannerAnimation.duration}s ${config.behavior.bannerAnimation.easing};${config.bannerStyle.border.enabled ? `border: ${config.bannerStyle.border.width}${config.bannerStyle.border.style}${config.bannerStyle.border.color};` : 'border: none;'}overflow: hidden;}.cookie-consent-banner.show {transform: translateY(0);opacity: 1;display: block;}.main-cookie-consent-content h2 {margin: 0 0 16px 0;font-size: ${config.bannerStyle.title.fontSize};color: ${config.bannerStyle.title.color};font-weight: ${config.bannerStyle.title.fontWeight};line-height: 1.4;letter-spacing: -0.2px;}.main-cookie-consent-content p {margin: 0 0 10px 0;font-size: ${config.bannerStyle.description.fontSize};color: ${config.bannerStyle.description.color};line-height: ${config.bannerStyle.description.lineHeight};}.main-privacy-policy-link {color: ${config.bannerStyle.linkColor}!important;text-decoration: none !important;font-size: 13px !important;font-weight: 500 !important;display: inline-block !important;margin-bottom: 8px !important;transition: color 0.2s ease !important;}.main-privacy-policy-link:hover {color: ${config.bannerStyle.linkHoverColor};}.all-cookie-consent-buttons {display: flex;flex-direction: column;gap: 12px;margin-top: 8px;}.cookie-btn {padding: ${config.buttonStyle.padding};border-radius: ${config.buttonStyle.borderRadius};cursor: pointer;font-weight: ${config.buttonStyle.fontWeight};font-size: ${config.buttonStyle.fontSize};transition: ${config.buttonStyle.transition};text-align: center;border: none;flex: 1;letter-spacing: 0.2px;}.main-adjust-button {background-color: ${config.buttonStyle.adjust.background};color: ${config.buttonStyle.adjust.color};border: ${config.buttonStyle.adjust.border};}.main-adjust-button:hover {background-color: ${config.buttonStyle.adjust.hover.background};color: ${config.buttonStyle.adjust.hover.color};transform: ${config.buttonStyle.adjust.hover.transform};}.main-reject-btn {background-color: ${config.buttonStyle.reject.background};color: ${config.buttonStyle.reject.color};border: ${config.buttonStyle.reject.border};}.main-reject-btn:hover {background-color: ${config.buttonStyle.reject.hover.background};color: ${config.buttonStyle.reject.hover.color};transform: ${config.buttonStyle.reject.hover.transform};}.main-accept-button {background-color: ${config.buttonStyle.accept.background};color: ${config.buttonStyle.accept.color};border: ${config.buttonStyle.accept.border};}.main-accept-button:hover {background-color: ${config.buttonStyle.accept.hover.background};color: ${config.buttonStyle.accept.hover.color};transform: ${config.buttonStyle.accept.hover.transform};}.main-save-btn {background-color: ${config.buttonStyle.save.background};color: ${config.buttonStyle.save.color};border: ${config.buttonStyle.save.border};}.main-save-btn:hover {background-color: ${config.buttonStyle.save.hover.background};color: ${config.buttonStyle.save.hover.color};transform: ${config.buttonStyle.save.hover.transform};box-shadow: 0 5px 10px rgba(0,0,0,0.15);}.modal-buttons-container {display: flex;gap: 12px;margin-top: 15px;}.modal-buttons-container .cookie-btn {flex: 1;}.language-selector {position: absolute;top: 15px;right: 15px;}.language-selector select {padding: 6px 10px;border-radius: 6px;border: 1px solid #e0e0e0;background-color: #f8f9fa;font-size: 13px;color: #333;cursor: pointer;transition: all 0.2s ease;}.language-selector select:hover {border-color: ${config.bannerStyle.linkColor};background-color: #fff;}.language-selector select:focus {outline: none;border-color: ${config.bannerStyle.linkColor};box-shadow: 0 0 0 2px rgba(52,152,219,0.2);}.cookie-settings-modal {display: none;position: fixed;top: 0;left: 0;width: 100%;height: 100%;background-color: rgba(0,0,0,0.7);z-index: 10000;overflow-y: auto;padding: 30px 0;opacity: 0;transition: opacity ${config.behavior.modalAnimation.duration}s ${config.behavior.modalAnimation.easing};}.cookie-blur-overlay {position: fixed;top: 0;left: 0;width: 100%;height: 100%;backdrop-filter: blur(5px);-webkit-backdrop-filter: blur(5px);z-index: 9998;display: none;pointer-events: none;}.cookie-blur-overlay.block-clicks {pointer-events: auto;cursor: default;<-- CHANGED TO "default" }.no-scroll {overflow: hidden !important;}.cookie-settings-modal.show {display: flex;align-items: center;justify-content: center;opacity: 1;}.cookie-settings-content {background-color: ${config.modalStyle.background};margin: 0 auto;width: ${config.modalStyle.width};max-height: ${config.modalStyle.maxHeight};border-radius: ${config.modalStyle.borderRadius};box-shadow: 0 10px 30px rgba(0,0,0,0.2);overflow: hidden;transform: translateY(20px);transition: transform ${config.behavior.modalAnimation.duration}s ${config.behavior.modalAnimation.easing};display: flex;flex-direction: column;}.cookie-settings-modal.show .cookie-settings-content {transform: translateY(0);}.cookie-settings-header {padding: 20px 30px;border-bottom: 1px solid #ecf0f1;display: flex;justify-content: space-between;align-items: center;background-color: ${config.modalStyle.header.background};}.cookie-settings-header h2 {margin: 0;color: ${config.modalStyle.header.textColor};font-size: ${config.modalStyle.header.fontSize};font-weight: ${config.modalStyle.header.fontWeight};}.close-modal {font-size: 28px;font-weight: bold;cursor: pointer;color: ${config.modalStyle.closeButton.color};background: none;border: none;padding: 0 10px;transition: color 0.2s ease;}.close-modal:hover {color: ${config.modalStyle.closeButton.hoverColor};}.cookie-settings-body {padding: 25px 30px;background-color: ${config.modalStyle.body.background};overflow-y: auto;flex: 1;}.cookie-category {margin-bottom: 25px;padding-bottom: 20px;border-bottom: 1px solid #ecf0f1;transition: all 0.3s ease;}.cookie-category:hover {background-color: ${config.categoryStyle.background};border-radius: ${config.categoryStyle.borderRadius};padding: 20px;margin-bottom: 20px;border: ${config.categoryStyle.border};}.cookie-category:last-child {border-bottom: none;margin-bottom: 0;padding-bottom: 0;}.toggle-container {display: flex;align-items: center;justify-content: space-between;margin-bottom: 12px;}.toggle-container h3 {margin: 0;font-size: ${config.categoryStyle.title.fontSize};color: ${config.categoryStyle.title.color};font-weight: ${config.categoryStyle.title.fontWeight};}.main-toggle-switch {position: relative;display: inline-block;width: ${config.toggleStyle.size};height: ${config.toggleStyle.height};}.main-toggle-switch input {opacity: 0;width: 0;height: 0;}.toggle-slider {position: absolute;cursor: pointer;top: 0;left: 0;right: 0;bottom: 0;background-color: ${config.toggleStyle.inactiveColor};transition: .4s;border-radius: 34px;}.toggle-slider:before {position: absolute;content: "";height: ${config.toggleStyle.sliderSize};width: ${config.toggleStyle.sliderSize};left: 3px;bottom: 3px;background-color: white;transition: .4s;border-radius: 50%;box-shadow: 0 2px 5px rgba(0,0,0,0.2);}input:checked + .toggle-slider {background-color: ${config.toggleStyle.activeColor};}input:checked + .toggle-slider:before {transform: translateX(24px);}input:disabled + .toggle-slider {background-color: #95a5a6;cursor: not-allowed;}.cookie-details-container {margin-top: 15px;border: 1px solid #e0e0e0;border-radius: 8px;overflow: hidden;transition: all 0.3s ease;}.cookie-details-container:hover {box-shadow: 0 3px 12px rgba(0,0,0,0.1);border-color: ${config.buttonStyle.accept.background};}.cookie-details-header {background-color: #f5f5f5;padding: 12px 18px;font-weight: 600;display: flex;justify-content: space-between;align-items: center;cursor: pointer;transition: all 0.2s ease;}.cookie-details-header:hover {background-color: #eeeeee;}.main-cookie-details-content {padding: 18px;background-color: #fafafa;border-top: 1px solid #e0e0e0;display: none;animation: fadeIn 0.3s ease;}@keyframes fadeIn {from {opacity: 0;transform: translateY(-10px);}to {opacity: 1;transform: translateY(0);}}.main-cookie-details-table {width: 100%;border-collapse: collapse;font-size: 13px;}.main-cookie-details-table th {text-align: left;padding: 10px 12px;background-color: #f0f0f0;font-weight: 600;border-bottom: 2px solid #e0e0e0;color: ${config.bannerStyle.title.color};}.main-cookie-details-table td {padding: 10px 12px;border-bottom: 1px solid #e0e0e0;color: ${config.bannerStyle.description.color};}.main-cookie-details-table tr:last-child td {border-bottom: none;}.main-cookie-details-table tr:hover {background-color: #f5f5f5;}.main-cookie-details-table code {background-color: #f0f0f0;padding: 2px 5px;border-radius: 3px;font-family: monospace;color: ${config.bannerStyle.title.color};}.see-analytics-container {margin-bottom: 15px;text-align: center;}.see-analytics-link {color: ${config.bannerStyle.linkColor};text-decoration: none;font-size: 13px;font-weight: 500;display: inline-block;transition: color 0.2s ease;display: none;}.see-analytics-link:hover {color: ${config.bannerStyle.linkHoverColor};text-decoration: underline;}.cookie-value-cell {position: relative;}.cookie-value-full {word-break: break-all;}.toggle-cookie-value {background: none;border: none;color: ${config.bannerStyle.linkColor};text-decoration: underline;cursor: pointer;font-size: 12px;padding: 0;margin-top: 5px;display: block;}.toggle-cookie-value:hover {color: ${config.bannerStyle.linkHoverColor};}.no-cookies-message {padding: 15px;text-align: center;color: #666;font-style: italic;}.cookie-settings-button {position: fixed;bottom: 30px;${config.behavior.floatingButtonPosition === 'left' ? 'left: 30px;' : 'right: 30px;'}width: ${config.floatingButtonStyle.size};height: ${config.floatingButtonStyle.size};background-color: ${config.floatingButtonStyle.background};border-radius: ${config.floatingButtonStyle.borderRadius};display: none;align-items: center;justify-content: center;cursor: pointer;box-shadow: ${config.floatingButtonStyle.boxShadow};z-index: 9998;transition: all 0.3s ease;opacity: 0;transform: translateY(20px);border: ${config.floatingButtonStyle.border};}.cookie-settings-button.show {opacity: 1;transform: translateY(0);}.cookie-settings-button:hover {background-color: ${config.floatingButtonStyle.hover.background};transform: ${config.floatingButtonStyle.hover.transform};box-shadow: ${config.floatingButtonStyle.hover.boxShadow};}#cookieFloatingButton.cookie-settings-button svg,#cookieFloatingButton.cookie-settings-button svg path {width: 40px;height: 40px;fill: ${config.floatingButtonStyle.iconColor}!important;stroke: none;transition: transform 0.3s ease;margin-top: 0px;}.cookie-settings-button:hover svg {transform: rotate(15deg);}.cookie-admin-button {position: fixed;${config.behavior.adminButtonPosition === 'left' ? 'left: 30px;bottom: 100px;' : 'right: 30px;bottom: 100px;'}width: ${config.adminButtonStyle.size};height: ${config.adminButtonStyle.size};background-color: ${config.adminButtonStyle.background};border-radius: ${config.adminButtonStyle.borderRadius};display: none;align-items: center;justify-content: center;cursor: pointer;box-shadow: ${config.adminButtonStyle.boxShadow};z-index: 9997;transition: all 0.3s ease;opacity: 0;transform: translateY(20px);border: ${config.adminButtonStyle.border};}.cookie-admin-button.show {opacity: 1;transform: translateY(0);}.cookie-admin-button:hover {background-color: ${config.adminButtonStyle.hover.background};transform: ${config.adminButtonStyle.hover.transform};box-shadow: ${config.adminButtonStyle.hover.boxShadow};}.cookie-admin-button svg {width: 28px;height: 28px;fill: ${config.adminButtonStyle.iconColor};transition: transform 0.3s ease;}.cookie-admin-button:hover svg {transform: rotate(15deg);}.cookie-analytics-modal {display: none;position: fixed;top: 0;left: 0;width: 100%;height: 100%;background-color: rgba(0,0,0,0.7);z-index: 10001;overflow-y: auto;padding: 30px 0;opacity: 0;transition: opacity ${config.behavior.dashboardAnimation.duration}s ${config.behavior.dashboardAnimation.easing};}.cookie-analytics-modal.show {display: flex;align-items: center;justify-content: center;opacity: 1;}.cookie-analytics-content {background-color: ${config.dashboardStyle.background};margin: 0 auto;width: ${config.dashboardStyle.width};max-height: ${config.dashboardStyle.maxHeight};border-radius: ${config.dashboardStyle.borderRadius};box-shadow: 0 10px 30px rgba(0,0,0,0.2);overflow: hidden;transform: translateY(20px);transition: transform ${config.behavior.dashboardAnimation.duration}s ${config.behavior.dashboardAnimation.easing};display: flex;flex-direction: column;}.cookie-analytics-modal.show .cookie-analytics-content {transform: translateY(0);}.cookie-analytics-header {padding: 20px 30px;border-bottom: 1px solid #ecf0f1;display: flex;justify-content: space-between;align-items: center;background-color: ${config.dashboardStyle.header.background};}.cookie-analytics-header h2 {margin: 0;color: ${config.dashboardStyle.header.textColor};font-size: ${config.dashboardStyle.header.fontSize};font-weight: ${config.dashboardStyle.header.fontWeight};}.close-analytics-modal {font-size: 28px;font-weight: bold;cursor: pointer;color: ${config.modalStyle.closeButton.color};background: none;border: none;padding: 0 10px;transition: color 0.2s ease;}.close-analytics-modal:hover {color: ${config.modalStyle.closeButton.hoverColor};}.cookie-analytics-body {padding: 25px 30px;background-color: ${config.dashboardStyle.body.background};overflow-y: auto;flex: 1;}.analytics-dashboard {font-family: 'Inter',-apple-system,BlinkMacSystemFont,sans-serif;}.analytics-dashboard h3 {color: ${config.bannerStyle.title.color};margin-top: 0;margin-bottom: 20px;font-size: 1.3rem;}.stats-summary {display: grid;grid-template-columns: repeat(4,1fr);gap: 15px;margin-bottom: 30px;}.stat-card {background-color: ${config.dashboardStyle.statCards.background};border-radius: ${config.dashboardStyle.statCards.borderRadius};padding: 15px;text-align: center;transition: all 0.3s ease;}.stat-card:hover {transform: translateY(-3px);box-shadow: 0 5px 15px rgba(0,0,0,0.1);}.stat-card.accepted {border-top: 4px solid ${config.dashboardStyle.statCards.acceptedColor};}.stat-card.rejected {border-top: 4px solid ${config.dashboardStyle.statCards.rejectedColor};}.stat-card.custom {border-top: 4px solid ${config.dashboardStyle.statCards.customColor};}.stat-card.total {border-top: 4px solid ${config.dashboardStyle.statCards.totalColor};}.stat-card h4 {margin: 0 0 10px 0;font-size: 1rem;color: ${config.bannerStyle.description.color};}.stat-value {font-size: 1.8rem;font-weight: 700;color: ${config.bannerStyle.title.color};margin-bottom: 5px;}.stat-percentage {font-size: 1rem;color: ${config.bannerStyle.description.color};}.time-based-stats {display: grid;grid-template-columns: 1fr;gap: 30px;}.time-stat {background-color: ${config.dashboardStyle.statCards.background};border-radius: ${config.dashboardStyle.statCards.borderRadius};padding: 20px;}.time-stat h4 {margin: 0 0 15px 0;font-size: 1.1rem;color: ${config.bannerStyle.title.color};}.stat-bars {display: grid;grid-template-columns: 1fr;gap: 10px;}.stat-bar-container {margin-bottom: 15px;}.stat-bar-label {font-size: 0.85rem;color: ${config.bannerStyle.description.color};margin-bottom: 5px;}.stat-bar {height: ${config.dashboardStyle.barChart.height};background-color: ${config.dashboardStyle.barChart.background};border-radius: ${config.dashboardStyle.barChart.borderRadius};overflow: hidden;display: flex;}.stat-bar-segment {height: 100%;}.stat-bar-segment.accepted {background-color: ${config.dashboardStyle.barChart.acceptedColor};}.stat-bar-segment.rejected {background-color: ${config.dashboardStyle.barChart.rejectedColor};}.stat-bar-segment.custom {background-color: ${config.dashboardStyle.barChart.customColor};}.stat-bar-legend {display: flex;justify-content: space-between;font-size: 0.75rem;color: ${config.bannerStyle.description.color};margin-top: 5px;}.cookie-settings-footer {padding: 20px 30px;background-color: ${config.modalStyle.footer.background};border-top: ${config.modalStyle.footer.borderTop};}.password-prompt {text-align: center;padding: 30px;}.password-prompt h3 {color: ${config.bannerStyle.title.color};margin-bottom: 20px;}.password-prompt input {padding: 12px 15px;border-radius: 6px;border: 1px solid #e0e0e0;width: 100%;max-width: 300px;margin-bottom: 15px;font-size: 14px;}.password-prompt button {padding: 12px 25px;background-color: ${config.buttonStyle.accept.background};color: white;border: none;border-radius: 6px;cursor: pointer;font-weight: 600;transition: all 0.2s ease;}.password-prompt button:hover {background-color: ${config.buttonStyle.accept.hover.background};}.error-message {color: ${config.buttonStyle.reject.color};margin-top: 10px;font-size: 14px;}@media (max-width: 900px) {.cookie-settings-content {width: 90%;max-height: 80vh;}.cookie-analytics-content {width: 90%;max-height: 80vh;}.stats-summary {grid-template-columns: repeat(2,1fr);}}@media (min-width: 768px) {.all-cookie-consent-buttons {flex-direction: row;}.cookie-btn {flex: 1;}}@media (max-width: 768px) {.cookie-consent-banner {width: 90%;${config.behavior.bannerPosition === 'left' ? 'left: 5%;' : 'right: 5%;'}bottom: 10px;padding: 20px;flex-direction: column;}.cookie-btn {flex: 1;min-width: 120px;}.cookie-btn:last-child {margin-bottom: 0;}.cookie-settings-header {padding: 15px 20px;}.cookie-settings-body {padding: 15px 20px;}.cookie-settings-footer {padding: 15px 20px;}.modal-buttons-container {flex-direction: column;}.modal-buttons-container .cookie-btn {width: 100%;margin-bottom: 8px;}.modal-buttons-container .cookie-btn:last-child {margin-bottom: 0;}.stats-summary {grid-template-columns: 1fr;}.main-cookie-details-table {display: block;overflow-x: auto;white-space: nowrap;}.main-cookie-details-table td {white-space: normal;}.cookie-value-cell {min-width: 120px;}}@media (max-width: 767px) {#cookieFloatingButton.mobile-only {bottom: 20px;right: 20px;}}@media (min-width: 768px) {#cookieFloatingButton {${config.behavior.floatingButtonPosition === 'left' ? 'left: 30px;' : 'right: 30px;'}}}@media (max-width: 480px) {.cookie-consent-banner {padding: 15px;flex-direction: column;width: calc(100% - 30px);${config.behavior.bannerPosition === 'left' ? 'left: 15px;' : 'right: 15px;'}}.main-cookie-consent-content h2 {font-size: 1.1rem;}.main-cookie-consent-content p {font-size: 0.85rem;margin-bottom: 15px;}.main-privacy-policy-link {margin-bottom: 15px;}.cookie-btn {padding: 10px;font-size: 0.85rem;}.cookie-settings-button {width: 50px;height: 50px;bottom: 15px;${config.behavior.floatingButtonPosition === 'left' ? 'left: 15px;' : 'right: 15px;'}}.cookie-admin-button {width: 50px;height: 50px;${config.behavior.adminButtonPosition === 'left' ? 'left: 15px;bottom: 80px;' : 'right: 15px;bottom: 80px;'}}.cookie-settings-button svg {width: 22px;height: 22px;}.cookie-admin-button svg {width: 22px;height: 22px;}.cookie-settings-header h2 {font-size: 1.2rem;}.toggle-container h3 {font-size: 1rem;}.main-cookie-details-table {font-size: 0.8rem;}.main-cookie-details-table th,.main-cookie-details-table td {padding: 8px 10px;}}</style>`;document.body.insertAdjacentHTML('beforeend',html);}function shouldShowBanner() {if (!config.behavior.bannerSchedule.enabled) {return true;}const now = new Date();const currentDate = now.toISOString().split('T')[0];const currentTime = now.getHours() * 100 + now.getMinutes();const currentDay = now.getDay();if (config.behavior.bannerSchedule.durationDays) {const firstVisit = getCookie('first_visit_date');if (!firstVisit) {setCookie('first_visit_date',currentDate,config.behavior.bannerSchedule.durationDays);return true;}const firstVisitDate = new Date(firstVisit);const endDate = new Date(firstVisitDate);endDate.setDate(endDate.getDate() + config.behavior.bannerSchedule.durationDays);return now <= endDate;}if (config.behavior.bannerSchedule.durationMinutes) {const sessionStart = getCookie('session_start_time');if (!sessionStart) {setCookie('session_start_time',now.getTime().toString(),0.5);return true;}const sessionStartTime = parseInt(sessionStart);const endTime = sessionStartTime + (config.behavior.bannerSchedule.durationMinutes * 60 * 1000);return now.getTime() <= endTime;}const startDate = new Date(config.behavior.bannerSchedule.startDate);const endDate = new Date(config.behavior.bannerSchedule.endDate);if (now < startDate || now > endDate) {return false;}const startTime = parseInt(config.behavior.bannerSchedule.startTime.split(':')[0]) * 100 + parseInt(config.behavior.bannerSchedule.startTime.split(':')[1]);const endTime = parseInt(config.behavior.bannerSchedule.endTime.split(':')[0]) * 100 + parseInt(config.behavior.bannerSchedule.endTime.split(':')[1]);if (currentTime < startTime || currentTime > endTime) {return false;}if (config.behavior.bannerSchedule.daysOfWeek.length > 0 && !config.behavior.bannerSchedule.daysOfWeek.includes(currentDay)) {return false;}return true;}function initializeCookieConsent(detectedCookies,language) {if (!shouldShowOnCurrentUrl()) {console.log('Cookie consent banner disabled for this URL');return;}const consentGiven = getCookie('cookie_consent');const geoAllowed = checkGeoTargeting(locationData);const bannerShouldBeShown = geoAllowed && shouldShowBanner();if (!consentGiven && config.behavior.autoShow && bannerShouldBeShown) {const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);const delay = isMobile ? config.behavior.bannerDelayMobile : config.behavior.bannerDelay;setTimeout(() => {showCookieBanner();},delay * 1000);}else if (consentGiven) {const consentData = JSON.parse(consentGiven);updateConsentMode(consentData);loadCookiesAccordingToConsent(consentData);if (config.behavior.showFloatingButton) {showFloatingButton();}}function initializeClarity(consentGranted) {if (!config.clarityConfig.enabled) return;const consentRequired = isEEAVisitor();if (consentGranted || !consentRequired) {if (typeof window.clarity === 'undefined') {(function(c,l,a,r,i,t,y){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);})(window,document,"clarity","script",config.clarityConfig.projectId);}ensureClarityConsentSignal(consentGranted);}else if (config.clarityConfig.loadBeforeConsent === false) {window.clarity = window.clarity || function() {(window.clarity.q = window.clarity.q || []).push(arguments);};window.clarity('consent',false);}}function sendClarityConsentSignal(consentGranted) {if (!config.clarityConfig.enabled || !config.clarityConfig.sendConsentSignal) return;try {if (typeof window.clarity !== 'undefined') {window.clarity('consent',consentGranted);console.log('Microsoft Clarity consent signal sent:',consentGranted);window.dataLayer.push({'event': 'clarity_consent_signal','clarity_consent': consentGranted,'timestamp': new Date().toISOString(),'location_data': locationData });}}catch (error) {console.error('Failed to send Clarity consent signal:',error);}}changeLanguage(config.languageConfig.defaultLanguage);const languageSelect = document.getElementById('cookieLanguageSelect');if (languageSelect) {languageSelect.value = config.languageConfig.defaultLanguage;languageSelect.addEventListener('change',function() {changeLanguage(this.value);});}setupEventListeners();setupBannerTriggers();document.querySelectorAll('.cookie-details-header').forEach(header => {header.addEventListener('click',function() {const content = this.nextElementSibling;const toggle = this.querySelector('.toggle-details');if (content.style.display === 'none') {content.style.display = 'block';toggle.textContent = 'âˆ’';}else {content.style.display = 'none';toggle.textContent = '+';}});});document.addEventListener('click',function(e) {if (e.target.classList.contains('toggle-cookie-value')) {const cell = e.target.closest('.cookie-value-cell');const full = cell.querySelector('.cookie-value-full');const truncated = cell.querySelector('.cookie-value-truncated');if (e.target.dataset.state === 'truncated') {full.style.display = 'inline';truncated.style.display = 'none';e.target.textContent = 'Hide full';e.target.dataset.state = 'full';}else {full.style.display = 'none';truncated.style.display = 'inline';e.target.textContent = 'Show full';e.target.dataset.state = 'truncated';}}});if (config.analytics.enabled && config.analytics.showDashboard && config.behavior.showAdminButton) {const adminButton = document.getElementById('cookieAdminButton');if (adminButton) {adminButton.addEventListener('click',showAnalyticsDashboard);setTimeout(() => {adminButton.style.display = 'flex';adminButton.classList.add('show');},100);}}if (config.analytics.passwordProtect && !isDashboardAuthenticated) {setupPasswordPromptEvents();}const seeAnalyticsLink = document.querySelector('.see-analytics-link');if (seeAnalyticsLink) {seeAnalyticsLink.addEventListener('click',function(e) {e.preventDefault();showAnalyticsDashboard();});}if (config.behavior.bannerSchedule.enabled && config.behavior.bannerSchedule.durationMinutes) {if (bannerTimer) {clearTimeout(bannerTimer);}bannerTimer = setTimeout(() => {if (!getCookie('cookie_consent')) {hideCookieBanner();}},config.behavior.bannerSchedule.durationMinutes * 60 * 1000);}}function setupPasswordPromptEvents() {const passwordSubmit = document.getElementById('dashboardPasswordSubmit');if (passwordSubmit) {passwordSubmit.addEventListener('click',function() {const passwordInput = document.getElementById('dashboardPasswordInput');const errorMessage = document.getElementById('passwordError');const lang = document.getElementById('cookieLanguageSelect') ? document.getElementById('cookieLanguageSelect').value : 'en';if (passwordInput.value === config.analytics.dashboardPassword) {isDashboardAuthenticated = true;setCookie('dashboard_auth','true',config.analytics.passwordCookieDuration);document.querySelector('.cookie-analytics-body').innerHTML = generateAnalyticsDashboard(lang);}else {errorMessage.textContent = translations[lang].passwordIncorrect;}});}}function setupBannerTriggers() {if (!config.bannerTriggers.enabled) return;if (config.bannerTriggers.triggerText) {const elements = Array.from(document.querySelectorAll('*')).filter(el => el.textContent.trim() === config.bannerTriggers.triggerText );elements.forEach(element => {element.style.cursor = 'pointer';element.addEventListener('click',function(e) {e.preventDefault();showCookieBanner();});});}if (config.bannerTriggers.triggerClass) {const elements = document.querySelectorAll('.' + config.bannerTriggers.triggerClass);elements.forEach(element => {element.style.cursor = 'pointer';element.addEventListener('click',function(e) {e.preventDefault();showCookieBanner();});});}if (config.bannerTriggers.triggerId) {const element = document.getElementById(config.bannerTriggers.triggerId);if (element) {element.style.cursor = 'pointer';element.addEventListener('click',function(e) {e.preventDefault();showCookieBanner();});}}}function setupEventListeners() {document.getElementById('acceptAllBtn').addEventListener('click',function() {acceptAllCookies();hideCookieBanner();if (config.behavior.showFloatingButton) {showFloatingButton();}});document.getElementById('rejectAllBtn').addEventListener('click',function() {rejectAllCookies();hideCookieBanner();if (config.behavior.showFloatingButton) {showFloatingButton();}});document.getElementById('adjustConsentBtn').addEventListener('click',function() {showCookieSettings();hideCookieBanner();});document.getElementById('acceptAllSettingsBtn').addEventListener('click',function() {acceptAllCookies();hideCookieSettings();if (config.behavior.showFloatingButton) {showFloatingButton();}});document.getElementById('rejectAllSettingsBtn').addEventListener('click',function() {rejectAllCookies();hideCookieSettings();if (config.behavior.showFloatingButton) {showFloatingButton();}});document.getElementById('saveSettingsBtn').addEventListener('click',function() {saveCustomSettings();hideCookieSettings();if (config.behavior.showFloatingButton) {showFloatingButton();}});document.querySelector('.close-modal').addEventListener('click',function() {hideCookieSettings();if (!getCookie('cookie_consent')) {showCookieBanner();}});document.querySelector('.close-analytics-modal').addEventListener('click',function() {hideAnalyticsDashboard();});document.getElementById('cookieFloatingButton').addEventListener('click',function() {if (!document.getElementById('cookieConsentBanner').classList.contains('show')) {showCookieBanner();}else {hideCookieBanner();}});}function showCookieBanner() {const banner = document.getElementById('cookieConsentBanner');banner.style.display = 'block';setTimeout(() => {banner.classList.add('show');},10);bannerShown = true;enableInteractionRestrictions();}function hideCookieBanner() {const banner = document.getElementById('cookieConsentBanner');banner.classList.remove('show');setTimeout(() => {banner.style.display = 'none';},400);bannerShown = false;disableInteractionRestrictions();}function showCookieSettings() {const modal = document.getElementById('cookieSettingsModal');modal.style.display = 'flex';setTimeout(() => {modal.classList.add('show');},10);hideCookieBanner();}function hideCookieSettings() {const modal = document.getElementById('cookieSettingsModal');modal.classList.remove('show');setTimeout(() => {modal.style.display = 'none';},300);}function showAnalyticsDashboard() {const lang = document.getElementById('cookieLanguageSelect') ? document.getElementById('cookieLanguageSelect').value : 'en';if (config.analytics.passwordProtect && !isDashboardAuthenticated) {const modal = document.getElementById('cookieAnalyticsModal');modal.style.display = 'flex';setTimeout(() => {modal.classList.add('show');},10);}else {const modal = document.getElementById('cookieAnalyticsModal');document.querySelector('.cookie-analytics-body').innerHTML = generateAnalyticsDashboard(lang);modal.style.display = 'flex';setTimeout(() => {modal.classList.add('show');},10);}}function hideAnalyticsDashboard() {const modal = document.getElementById('cookieAnalyticsModal');modal.classList.remove('show');setTimeout(() => {modal.style.display = 'none';},300);}function showFloatingButton() {const button = document.getElementById('cookieFloatingButton');button.style.display = 'flex';setTimeout(() => {button.classList.add('show');},100);}function hideFloatingButton() {const button = document.getElementById('cookieFloatingButton');button.classList.remove('show');setTimeout(() => {button.style.display = 'none';},300);}function enableInteractionRestrictions() {if (!config.behavior.restrictInteraction.enabled) return;const overlay = document.getElementById('cookieBlurOverlay');if (config.behavior.restrictInteraction.blurBackground) {overlay.style.backdropFilter = `blur(${config.behavior.restrictInteraction.blurDensity})`;overlay.style.webkitBackdropFilter = `blur(${config.behavior.restrictInteraction.blurDensity})`;overlay.style.display = 'block';}if (config.behavior.restrictInteraction.preventScroll) {document.body.classList.add('no-scroll');}if (config.behavior.restrictInteraction.preventClick) {overlay.classList.add('block-clicks');overlay.addEventListener('click',function(e) {e.stopPropagation();e.preventDefault();},true);}}function disableInteractionRestrictions() {const overlay = document.getElementById('cookieBlurOverlay');overlay.style.display = 'none';document.body.classList.remove('no-scroll');overlay.classList.remove('block-clicks');overlay.removeEventListener('click',function(e) {e.stopPropagation();e.preventDefault();},true);}function toggleRestrictions(enable) {if (enable) {enableInteractionRestrictions();}else {disableInteractionRestrictions();}}function toggleScrollRestriction(enable) {config.behavior.restrictInteraction.preventScroll = enable;if (enable) {document.body.classList.add('no-scroll');}else {document.body.classList.remove('no-scroll');}}function toggleClickRestriction(enable) {config.behavior.restrictInteraction.preventClick = enable;const overlay = document.getElementById('cookieBlurOverlay');if (enable) {overlay.classList.add('block-clicks');}else {overlay.classList.remove('block-clicks');}}function toggleBlurEffect(enable) {config.behavior.restrictInteraction.blurBackground = enable;const overlay = document.getElementById('cookieBlurOverlay');overlay.style.display = enable ? 'block' : 'none';}function setBlurDensity(density) {config.behavior.restrictInteraction.blurDensity = density;const overlay = document.getElementById('cookieBlurOverlay');overlay.style.backdropFilter = `blur(${density})`;overlay.style.webkitBackdropFilter = `blur(${density})`;}function acceptAllCookies() {initializeClarity(true);sendClarityConsentSignal(true);const consentData = {status: 'accepted',gcs: 'G111',categories: {functional: true,analytics: true,performance: true,advertising: true,uncategorized: true },timestamp: new Date().getTime() };addStoredParamsToURL();setCookie('cookie_consent',JSON.stringify(consentData),365);updateConsentMode(consentData);loadCookiesAccordingToConsent(consentData);if (config.analytics.enabled) {updateConsentStats('accepted');}window.dataLayer.push({'event': 'cookie_consent_accepted','consent_mode': {'ad_storage': 'granted','analytics_storage': 'granted','ad_user_data': 'granted','ad_personalization': 'granted','personalization_storage': 'granted','functionality_storage': 'granted','security_storage': 'granted' },'gcs': 'G111','consent_status': 'accepted','consent_categories': consentData.categories,'timestamp': new Date().toISOString(),'location_data': locationData });disableInteractionRestrictions();}function rejectAllCookies() {initializeClarity(false);sendClarityConsentSignal(false);const consentData = {status: 'rejected',gcs: 'G100',categories: {functional: false,analytics: false,performance: false,advertising: false,uncategorized: false },timestamp: new Date().getTime() };setCookie('cookie_consent',JSON.stringify(consentData),365);updateConsentMode(consentData);clearNonEssentialCookies();if (config.analytics.enabled) {updateConsentStats('rejected');}window.dataLayer.push({'event': 'cookie_consent_rejected','consent_mode': {'ad_storage': 'denied','analytics_storage': 'denied','ad_user_data': 'denied','ad_personalization': 'denied','personalization_storage': 'denied','functionality_storage': 'denied','security_storage': 'granted' },'gcs': 'G100','consent_status': 'rejected','consent_categories': consentData.categories,'timestamp': new Date().toISOString(),'location_data': locationData });disableInteractionRestrictions();}function saveCustomSettings() {const analyticsChecked = document.querySelector('input[data-category="analytics"]').checked;initializeClarity(analyticsChecked);sendClarityConsentSignal(analyticsChecked);const advertisingChecked = document.querySelector('input[data-category="advertising"]').checked;addStoredParamsToURL();let gcsSignal;if (analyticsChecked && advertisingChecked) {gcsSignal = 'G111';}else if (!analyticsChecked && !advertisingChecked) {gcsSignal = 'G100';}else if (analyticsChecked && !advertisingChecked) {gcsSignal = 'G101';}else if (!analyticsChecked && advertisingChecked) {gcsSignal = 'G110';}const consentData = {status: 'custom',gcs: gcsSignal,categories: {functional: true,analytics: analyticsChecked,performance: document.querySelector('input[data-category="performance"]').checked,advertising: advertisingChecked,uncategorized: document.querySelector('input[data-category="uncategorized"]') ? document.querySelector('input[data-category="uncategorized"]').checked : false },timestamp: new Date().getTime() };setCookie('cookie_consent',JSON.stringify(consentData),365);updateConsentMode(consentData);loadCookiesAccordingToConsent(consentData);if (!consentData.categories.analytics) clearCategoryCookies('analytics');if (!consentData.categories.performance) clearCategoryCookies('performance');if (!consentData.categories.advertising) clearCategoryCookies('advertising');if (!consentData.categories.uncategorized) clearCategoryCookies('uncategorized');if (config.analytics.enabled) {updateConsentStats('custom');}const consentStates = {'ad_storage': consentData.categories.advertising ? 'granted' : 'denied','analytics_storage': consentData.categories.analytics ? 'granted' : 'denied','ad_user_data': consentData.categories.advertising ? 'granted' : 'denied','ad_personalization': consentData.categories.advertising ? 'granted' : 'denied','personalization_storage': consentData.categories.performance ? 'granted' : 'denied','functionality_storage': consentData.categories.functional ? 'granted' : 'denied','security_storage': 'granted' };if (analyticsChecked && !advertisingChecked) {window.dataLayer.push({'event': 'analytics_cookie_accepted','consent_mode': {'analytics_storage': 'granted','ad_storage': 'denied' },'gcs': 'G101','consent_status': 'custom','consent_categories': consentData.categories,'timestamp': new Date().toISOString(),'location_data': locationData });}else if (advertisingChecked && !analyticsChecked) {window.dataLayer.push({'event': 'marketing_cookie_accepted','consent_mode': {'ad_storage': 'granted','analytics_storage': 'denied' },'gcs': 'G110','consent_status': 'custom','consent_categories': consentData.categories,'timestamp': new Date().toISOString(),'location_data': locationData });}else {window.dataLayer.push({'event': 'cookie_consent_custom','consent_mode': consentStates,'gcs': gcsSignal,'consent_status': 'custom','consent_categories': consentData.categories,'timestamp': new Date().toISOString(),'location_data': locationData });}disableInteractionRestrictions();}function clearNonEssentialCookies() {const cookies = document.cookie.split(';');cookies.forEach(cookie => {const [nameValue] = cookie.trim().split('=');const name = nameValue.trim();let isEssential = false;for (const pattern in cookieDatabase) {if (name.startsWith(pattern) && cookieDatabase[pattern].category === 'functional') {isEssential = true;break;}}if (!isEssential && name && name !== 'cookie_consent') {document.cookie = `${name}=;expires=Thu,01 Jan 1970 00:00:00 GMT;path=/;domain=${window.location.hostname}`;}});}function shouldShowOnCurrentUrl() {if (!config.urlFilter.enabled) {return true;}const currentUrl = window.location.href;const currentPath = window.location.pathname;if (config.urlFilter.hideOnUrls && config.urlFilter.hideOnUrls.length > 0) {for (const pattern of config.urlFilter.hideOnUrls) {if (matchesUrlPattern(currentUrl,currentPath,pattern)) {return false;}}return true;}if (config.urlFilter.showOnUrls && config.urlFilter.showOnUrls.length > 0) {for (const pattern of config.urlFilter.showOnUrls) {if (matchesUrlPattern(currentUrl,currentPath,pattern)) {return true;}}return false;}return true;}function matchesUrlPattern(url,path,pattern) {if (pattern.startsWith('http') && url === pattern) {return true;}if (pattern.startsWith('/') && !pattern.includes('*') && path === pattern) {return true;}if (pattern.endsWith('/*') && path.startsWith(pattern.slice(0,-2))) {return true;}if (pattern.startsWith('*') && pattern.endsWith('*') && url.includes(pattern.slice(1,-1))) {return true;}if (pattern.startsWith('*') && pattern.endsWith('*') && path.includes(pattern.slice(1,-1))) {return true;}return false;}function ensureClarityConsentSignal(consentGranted) {if (typeof window.clarity === 'function') {window.clarity('consent',consentGranted);}else {window.clarity = window.clarity || function() {(window.clarity.q = window.clarity.q || []).push(arguments);};window.clarity('consent',consentGranted);}console.log('Microsoft Clarity consent signal sent:',consentGranted);}function clearCategoryCookies(category) {const cookies = scanAndCategorizeCookies()[category];cookies.forEach(cookie => {document.cookie = `${cookie.name}=;expires=Thu,01 Jan 1970 00:00:00 GMT;path=/;domain=${window.location.hostname}`;});}function loadCookiesAccordingToConsent(consentData) {if (consentData.categories.advertising) {loadAdvertisingCookies();}if (consentData.categories.performance) {loadPerformanceCookies();}}function isClarityConsentRequired() {if (!config.clarityConfig.autoDetectRegion) return true;if (locationData && locationData.country) {const clarityRegions = EU_COUNTRIES;return clarityRegions.includes(locationData.country);}return true;}function initializeClarity(consentGranted) {if (!config.clarityConfig.enabled) return;const consentRequired = isClarityConsentRequired();if (consentGranted || !consentRequired) {if (typeof window.clarity === 'undefined') {(function(c,l,a,r,i,t,y){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);})(window,document,"clarity","script",config.clarityConfig.projectId);}setTimeout(() => {if (typeof window.clarity === 'function') {window.clarity('consent',consentGranted);}},500);}else {window.clarity = window.clarity || function() {(window.clarity.q = window.clarity.q || []).push(arguments);};window.clarity('consent',false);}}function sendClarityConsentSignal(consentGranted) {if (!config.clarityConfig.enabled || !config.clarityConfig.sendConsentSignal) return;try {ensureClarityConsentSignal(consentGranted);console.log('Microsoft Clarity consent signal sent:',consentGranted,'for region:',locationData?.country || 'unknown');window.dataLayer.push({'event': 'clarity_consent_signal','clarity_consent': consentGranted,'clarity_region': locationData?.country || 'unknown','timestamp': new Date().toISOString(),'location_data': locationData });}catch (error) {console.error('Failed to send Clarity consent signal:',error);}}function updateConsentMode(consentData) {const consentStates = {'ad_storage': consentData.categories.advertising ? 'granted' : 'denied','analytics_storage': consentData.categories.analytics ? 'granted' : 'denied','ad_user_data': consentData.categories.advertising ? 'granted' : 'denied','ad_personalization': consentData.categories.advertising ? 'granted' : 'denied','personalization_storage': consentData.categories.performance ? 'granted' : 'denied','functionality_storage': consentData.categories.functional ? 'granted' : 'denied','security_storage': 'granted' };let gcsSignal = 'G100';if (consentData.status === 'accepted') {gcsSignal = 'G111';}else if (consentData.status === 'custom') {if (consentData.categories.analytics && !consentData.categories.advertising) {gcsSignal = 'G101';}else if (consentData.categories.advertising && !consentData.categories.analytics) {gcsSignal = 'G110';}else if (consentData.categories.analytics && consentData.categories.advertising) {gcsSignal = 'G111';}else {gcsSignal = 'G100';}}gtag('consent','update',{...consentStates,});if (config.uetConfig.enabled) {const uetConsentState = consentData.categories.advertising ? 'granted' : 'denied';window.uetq.push('consent','update',{'ad_storage': uetConsentState });window.dataLayer.push({'event': 'uet_consent_update','uet_consent': {'ad_storage': uetConsentState,'status': consentData.status,'src': 'update','asc': uetConsentState === 'granted' ? 'G' : 'D','timestamp': new Date().toISOString() },'location_data': locationData });}if (config.clarityConfig.enabled) {const clarityConsent = consentData.categories.analytics;if (typeof window.clarity === 'function') {window.clarity('consent',clarityConsent);sendClarityConsentSignal(clarityConsent);}}window.dataLayer.push({'event': 'cookie_consent_update','consent_mode': consentStates,'gcs': gcsSignal,'consent_status': consentData.status,'consent_categories': consentData.categories,'timestamp': new Date().toISOString(),'location_data': locationData });}function setCookie(name,value,days) {let expires = "";if (days) {const date = new Date();date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));expires = ";expires=" + date.toUTCString();}document.cookie = name + "=" + (value || "") + expires + ";path=/;SameSite=Lax;Secure";}function getCookie(name) {const nameEQ = name + "=";const ca = document.cookie.split(';');for (let i = 0;i < ca.length;i++) {let c = ca[i];while (c.charAt(0) === ' ') c = c.substring(1,c.length);if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length,c.length);}return null;}function sanitizeParamValue(value) {if (typeof value !== 'string') return '';return value.trim().substring(0,config.queryParamsConfig.maxLength) .replace(/[<>"'`]/g,'');}function loadAdvertisingCookies() {console.log('Loading advertising cookies');}function loadPerformanceCookies() {console.log('Loading performance cookies');}document.addEventListener('DOMContentLoaded',async function() {try {if (!sessionStorage.getItem('locationData')) {console.log('Fetching fresh location data...');locationData = await fetchLocationData();}else {console.log('Using cached location data');locationData = JSON.parse(sessionStorage.getItem('locationData'));pushGeoDataToDataLayer(locationData);}console.log('Current location data:',locationData);}catch (e) {console.error('Failed to load location data:',e);}checkExistingClarityConsent();storeQueryParams();const existingConsent = getClarityConsentState();if (existingConsent !== null) {ensureClarityConsentSignal(existingConsent);}if (!isDomainAllowed()) {console.log('Cookie consent banner not shown - domain not allowed');return;}if (config.analytics.enabled) {loadAnalyticsData();}setDefaultUetConsent();await fetchLocationData();const geoAllowed = checkGeoTargeting(locationData);if (!geoAllowed) {console.log('Cookie consent banner not shown - geo-targeting restriction');return;}const detectedCookies = scanAndCategorizeCookies();const userLanguage = detectUserLanguage(locationData);injectConsentHTML(detectedCookies,userLanguage);initializeCookieConsent(detectedCookies,userLanguage);});function checkExistingClarityConsent() {const consentCookie = getCookie('cookie_consent');if (!consentCookie) return null;try {const consentData = JSON.parse(consentCookie);ensureClarityConsentSignal(consentData.categories.analytics);return consentData.categories.analytics;}catch (e) {return null;}}if (typeof window !== 'undefined') {window.cookieConsent = {showBanner: showCookieBanner,hideBanner: hideCookieBanner,showSettings: showCookieSettings,acceptAll: acceptAllCookies,rejectAll: rejectAllCookies,saveSettings: saveCustomSettings,changeLanguage: changeLanguage,showAnalytics: showAnalyticsDashboard,config: config,toggleRestrictions: toggleRestrictions,toggleScrollRestriction: toggleScrollRestriction,toggleClickRestriction: toggleClickRestriction,toggleBlurEffect: toggleBlurEffect,setBlurDensity: setBlurDensity };}
